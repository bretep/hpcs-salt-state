node:
  master: {% if master %}true{% else %}false{% endif %}
  data: {% if data %}true{% else %}false{% endif %}

path:
  conf: /etc/elasticsearch
  data: /mnt/elasticsearch
  logs: /var/log/elasticsearch

index:
  number_of_shards: {{ pillar['elasticsearch']['shards'] }}
  number_of_replicas: {{ pillar['elasticsearch']['replicas'] }}
  query.default_field: "@message"
  refresh_interval: 5s
  store:
    compress:
      stored: true
      tv: true
    throttle:
      type: merge
      max_bytes_per_sec: 3mb

cluster.routing.allocation:
  cluster_concurrent_rebalance: 4                                                                                                                                                                                 -  allow_rebalance: indices_primaries_active
  allow_rebalance: indices_primaries_active
  node_concurrent_recoveries: 3

network:
  publish_host: {{ pillar['elasticsearch']['publish'][grains['host']] }}
  tcp.keep_alive: true

discovery.zen:
  minimum_master_nodes: 1
  ping_timeout: 5s
  ping:
    multicast.enabled: false
    unicast.hosts:
    {%- if master %} [ "127.0.0.1" ]
    {%- else %} [ "{{ pillar['elasticsearch']['publish']['logstash'] }}" ]
    {%- endif %}
